// Code generated by v3/generator; DO NOT EDIT.
package compute

import (
	"context"

	"github.com/exoscale/egoscale/v3/oapi"
	"github.com/exoscale/egoscale/v3/utils"

	openapi_types "github.com/deepmap/oapi-codegen/pkg/types"
)

type Instance struct {
	oapiClient *oapi.ClientWithResponses
}

func NewInstance(c *oapi.ClientWithResponses) *Instance {
	return &Instance{c}
}

func (a *Instance) ResetPassword(ctx context.Context, id openapi_types.UUID) (*oapi.Operation, error) {
	resp, err := a.oapiClient.ResetInstancePasswordWithResponse(ctx, id)
	if err != nil {
		return nil, err
	}

	err = utils.ParseResponseError(resp.StatusCode(), resp.Body)
	if err != nil {
		return nil, err
	}

	return resp.JSON200, nil
}

func (a *Instance) Get(ctx context.Context, id openapi_types.UUID) (*oapi.Instance, error) {
	resp, err := a.oapiClient.GetInstanceWithResponse(ctx, id)
	if err != nil {
		return nil, err
	}

	err = utils.ParseResponseError(resp.StatusCode(), resp.Body)
	if err != nil {
		return nil, err
	}

	return resp.JSON200, nil
}

func (a *Instance) List(ctx context.Context, params *oapi.ListInstancesParams) ([]oapi.InstancesListElement, error) {
	resp, err := a.oapiClient.ListInstancesWithResponse(ctx, params)
	if err != nil {
		return nil, err
	}

	err = utils.ParseResponseError(resp.StatusCode(), resp.Body)
	if err != nil {
		return nil, err
	}

	return oapi.FromListInstancesResponse(resp), nil
}

