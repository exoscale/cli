name: "Build"
runs:
  using: "composite"
  steps:
    - uses: actions/checkout@v3
      with:
        fetch-depth: 0

    - run: make go.mk
      shell: bash

    - uses: ./go.mk/.github/actions/setup

    - uses: ./go.mk/.github/actions/pre-check

    - run: make build
      shell: bash

    - run: make test-verbose
      shell: bash

    - name: Run local integration tests
      run: |
        cd tests/integ/local
        go test -v
      shell: bash
